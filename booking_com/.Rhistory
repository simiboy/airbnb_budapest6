col = group_colors,
lwd = 2, pch = 16)
plot(count_per_district$date, count_per_district$n_listings, type = "n",
xlab = "Date", ylab = "Count of Listings",
main = "Number of Listings Over Time by District")
# Draw lines and points for each district
districts <- unique(count_per_district$district)
for(d in districts) {
d_data <- count_per_district[count_per_district$district == d, ]
# Sort by date to ensure lines connect correctly
d_data <- d_data[order(d_data$date), ]
lines(d_data$date, d_data$n_listings,
col = group_colors[d_data$group[1]], lwd = 2)
points(d_data$date, d_data$n_listings,
col = group_colors[d_data$group[1]], pch = 16)
}
# Add legend with only 3 items
legend("bottomright",
legend = names(group_colors),
col = group_colors,
lwd = 2, pch = 16)
warnings()
price_stats
count_per_district$group <- ifelse(count_per_district$district == "VI", "District VI",
ifelse(count_per_district$district %in% c("I","II","V","VII","VIII","IX","XI","XIII"),
"Inner Budapest", "Outer Budapest"))
group_colors <- c(
"District VI" = "red",
"Inner Budapest" = "darkgrey",
"Outer Budapest" = "lightgrey"
)
# Plot empty plot
plot(price_stats$date, price_stats$mean_price_sqm, type = "n",
xlab = "Date", ylab = "Mean Price (Ft/m²)",
main = "Mean Rent Price per m² Over Time by District")
# Draw lines and points for each district
districts <- unique(price_stats$district)
for(d in districts) {
d_data <- price_stats[price_stats$district == d, ]
# Sort by date to ensure lines connect correctly
d_data <- d_data[order(d_data$date), ]
lines(d_data$date, d_data$mean_price_sqm,
col = group_colors[d_data$group[1]], lwd = 2)
points(d_data$date, d_data$mean_price_sqm,
col = group_colors[d_data$group[1]], pch = 16)
}
# Add legend with only 3 items
legend("bottomright",
legend = names(group_colors),
col = group_colors,
lwd = 2, pch = 16)
plot(count_per_district$date, count_per_district$n_listings, type = "n",
xlab = "Date", ylab = "Count of Listings",
main = "Number of Listings Over Time by District")
# Draw lines and points for each district
districts <- unique(count_per_district$district)
for(d in districts) {
d_data <- count_per_district[count_per_district$district == d, ]
# Sort by date to ensure lines connect correctly
d_data <- d_data[order(d_data$date), ]
lines(d_data$date, d_data$n_listings,
col = group_colors[d_data$group[1]], lwd = 2)
points(d_data$date, d_data$n_listings,
col = group_colors[d_data$group[1]], pch = 16)
}
# Add legend with only 3 items
legend("bottomright",
legend = names(group_colors),
col = group_colors,
lwd = 2, pch = 16)
ggplot(all_data, aes(x = district, y = price_sqm, fill = group)) +
geom_boxplot() +
labs(title = "Price per m² Distribution by District", y = "Price (Ft/m²)", x = "District")
source("C:/Users/ThinkPad/Desktop/airbnb_scrape/ingatlan_com/analyze.R", echo = TRUE)
# Mean price per m² over time
ggplot(price_stats, aes(x = date, y = mean_price_sqm, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Mean Price (Ft/m²)",
color = "Group"
) +
theme_minimal()
price_stats <- price_stats %>%
mutate(
group = case_when(
district == "VI" ~ "District VI",
district %in% c("I","II","V","VII","VIII","IX","XI","XIII") ~ "Inner Budapest",
TRUE ~ "Outer Budapest"
)
)
ggplot(price_stats, aes(x = date, y = mean_price_sqm, color = group)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = c("District VI" = "red", "Inner Budapest" = "darkgrey", "Outer Budapest" = "lightgrey")) +
labs(title = "Mean Rent Price per m²: District VI vs Others",
x = "Date", y = "Mean Price (Ft/m²)", color = "Group") +
theme_minimal()
price_stats <- price_stats %>%
group_by(group) %>%
arrange(date) %>%
mutate(
price_change_pct = (mean_price_sqm / lag(mean_price_sqm) - 1) * 100
) %>%
ungroup()
# Plot
ggplot(price_stats, aes(x = date, y = price_change_pct, color = group)) +
geom_line(size = 1) +
geom_point(size = 2) +
labs(title = "Percentage Change in Mean Price per m² Over Time",
x = "Date", y = "% Change", color = "Group") +
theme_minimal()
ggplot(price_stats, aes(x = date, y = n_listings, color = group)) +
geom_line(size = 1) +
geom_point(size = 2) +
labs(title = "Number of Listings Over Time: District VI vs Others",
x = "Date", y = "Listings", color = "Group") +
theme_minimal()
ggplot(all_data, aes(x = group, y = price_sqm, fill = group)) +
geom_boxplot() +
scale_fill_manual(values = c("District VI" = "red", "Inner Budapest" = "darkgrey", "Outer Budapest" = "lightgrey")) +
labs(title = "Distribution of Price per m² by Group", x = "Group", y = "Price per m²") +
theme_minimal()
price_stats <- price_stats %>%
group_by(date) %>%
summarise(
VI_price = mean_price_sqm[group == "District VI"],
Inner_price = mean_price_sqm[group == "Inner Budapest"],
Outer_price = mean_price_sqm[group == "Outer Budapest"]
) %>%
mutate(
premium_vs_inner = VI_price / Inner_price - 1,
premium_vs_outer = VI_price / Outer_price - 1
)
# ---- Normalize values relative to first date ----
price_stats_rel <- price_stats %>%
group_by(district) %>%
arrange(date) %>%
mutate(
mean_price_sqm_rel = mean_price_sqm / first(mean_price_sqm) * 100,
n_listings_rel = n_listings / first(n_listings) * 100
) %>%
ungroup()
# ---- Relative Mean Price per m² Over Time ----
ggplot(price_stats_rel, aes(x = date, y = mean_price_sqm_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Relative Mean Price (% of first date)",
color = "Group"
) +
theme_minimal()
# ---- Relative Number of Listings Over Time ----
ggplot(price_stats_rel, aes(x = date, y = n_listings_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Number of Listings Over Time by District",
x = "Date",
y = "Relative Listings (% of first date)",
color = "Group"
) +
theme_minimal()
# ---- 4. Visualizations with ggplot2 ----
group_colors <- c(
"District VI" = "red",
"Inner Budapest" = "orange",
"Outer Budapest" = "lightgrey"
)
# Mean price per m² over time
ggplot(price_stats, aes(x = date, y = mean_price_sqm, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Mean Price (Ft/m²)",
color = "Group"
) +
theme_minimal()
# Number of listings over time
ggplot(price_stats, aes(x = date, y = n_listings, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Number of Listings Over Time by District",
x = "Date",
y = "Count of Listings",
color = "Group"
) +
theme_minimal()
# ---- Normalize values relative to first date ----
price_stats_rel <- price_stats %>%
group_by(district) %>%
arrange(date) %>%
mutate(
mean_price_sqm_rel = mean_price_sqm / first(mean_price_sqm) * 100,
n_listings_rel = n_listings / first(n_listings) * 100
) %>%
ungroup()
# ---- Relative Mean Price per m² Over Time ----
ggplot(price_stats_rel, aes(x = date, y = mean_price_sqm_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Relative Mean Price (% of first date)",
color = "Group"
) +
theme_minimal()
# ---- Relative Number of Listings Over Time ----
ggplot(price_stats_rel, aes(x = date, y = n_listings_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Number of Listings Over Time by District",
x = "Date",
y = "Relative Listings (% of first date)",
color = "Group"
) +
theme_minimal()
# ---- Relative Mean Price per m² Over Time ----
ggplot(price_stats_rel, aes(x = date, y = mean_price_sqm_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Relative Mean Price (% of first date)",
color = "Group"
) +
theme_minimal()
# Number of listings over time
ggplot(price_stats, aes(x = date, y = n_listings, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Number of Listings Over Time by District",
x = "Date",
y = "Count of Listings",
color = "Group"
) +
theme_minimal()
# ---- Normalize values relative to first date ----
price_stats_rel <- price_stats %>%
group_by(district) %>%
arrange(date) %>%
mutate(
mean_price_sqm_rel = mean_price_sqm / first(mean_price_sqm) * 100,
n_listings_rel = n_listings / first(n_listings) * 100
) %>%
ungroup()
# ---- Normalize values relative to first date ----
price_stats_rel <- price_stats %>%
group_by(district) %>%
arrange(date) %>%
mutate(
mean_price_sqm_rel = mean_price_sqm / first(mean_price_sqm) * 100,
n_listings_rel = n_listings / first(n_listings) * 100
) %>%
ungroup()
# ---- Relative Mean Price per m² Over Time ----
ggplot(price_stats_rel, aes(x = date, y = mean_price_sqm_rel, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Relative Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Relative Mean Price (% of first date)",
color = "Group"
) +
theme_minimal()
# Mean price per m² over time
ggplot(price_stats, aes(x = date, y = mean_price_sqm, color = group, group = district)) +
geom_line(size = 1) +
geom_point(size = 2) +
scale_color_manual(values = group_colors) +
labs(
title = "Mean Rent Price per m² Over Time by District",
x = "Date",
y = "Mean Price (Ft/m²)",
color = "Group"
) +
theme_minimal()
setwd("C:/Users/ThinkPad/Desktop/airbnb_scrape/booking_com")
# Load required libraries
library(tidyverse)
library(lubridate)
# Set folder where CSV files are stored
data_folder <- "data scraped"
# List all CSV files in the folder
files <- list.files(path = data_folder, pattern = "\\.csv$", full.names = TRUE)
# Set folder where CSV files are stored
data_folder <- "data"
# List all CSV files in the folder
files <- list.files(path = data_folder, pattern = "\\.csv$", full.names = TRUE)
# Function to read and clean individual CSV
read_listing <- function(file) {
df <- read_csv(file, col_types = cols(
district = col_integer(),
total_listings = col_integer(),
entire_homes = col_integer()
))
# Add a date column from the filename
df <- df %>%
mutate(date = ymd(basename(file) %>% str_remove("\\.csv")))
# Fill missing values with 0 for analysis
df <- df %>%
mutate(across(c(total_listings, entire_homes), ~replace_na(.x, 0)))
return(df)
}
# Read all CSVs and combine into one dataframe
all_data <- files %>% map_dfr(read_listing)
# Define groups
inner_city <- c(1,2,5,7,8,9,11,13)
district6 <- 6
outer_city <- setdiff(1:23, c(inner_city, district6))
all_data <- all_data %>%
mutate(group = case_when(
district == district6 ~ "District 6",
district %in% inner_city ~ "Inner City",
TRUE ~ "Outer City"
))
# Aggregate by group over time
grouped_data <- all_data %>%
group_by(date, group) %>%
summarise(
total_listings = sum(total_listings),
entire_homes = sum(entire_homes),
.groups = "drop"
)
# Plot total listings over time
ggplot(grouped_data, aes(x = date, y = total_listings, color = group)) +
geom_line(size = 1.2) +
geom_point(size = 2) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Total Listings Over Time in Budapest",
x = "Date",
y = "Total Listings",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# Plot entire homes over time
ggplot(grouped_data, aes(x = date, y = entire_homes, color = group)) +
geom_line(size = 1.2) +
geom_point(size = 2) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Entire Homes Over Time in Budapest",
x = "Date",
y = "Entire Homes",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# Optional: Percentage of entire homes per group over time
grouped_data <- grouped_data %>%
mutate(entire_home_pct = entire_homes / total_listings * 100)
ggplot(grouped_data, aes(x = date, y = entire_home_pct, color = group)) +
geom_line(size = 1.2) +
geom_point(size = 2) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Percentage of Entire Homes Over Time",
x = "Date",
y = "Entire Homes (%)",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
library(tidyverse)
library(lubridate)
# Folder with CSV files
data_folder <- "data scraped"
# List CSV files
files <- list.files(path = data_folder, pattern = "\\.csv$", full.names = TRUE)
# Function to read and clean CSV
read_listing <- function(file) {
df <- read_csv(file, col_types = cols(
district = col_integer(),
total_listings = col_integer(),
entire_homes = col_integer()
))
df <- df %>%
mutate(date = ymd(basename(file) %>% str_remove("\\.csv"))) %>%
mutate(across(c(total_listings, entire_homes), ~replace_na(.x, 0)))
return(df)
}
# Read all data
all_data <- files %>% map_dfr(read_listing)
# Define groups
inner_city <- c(1,2,5,7,8,9,11,13)
district6 <- 6
outer_city <- setdiff(1:23, c(inner_city, district6))
all_data <- all_data %>%
mutate(group = case_when(
district == district6 ~ "District 6",
district %in% inner_city ~ "Inner City",
TRUE ~ "Outer City"
))
# Plot all 23 districts over time
ggplot(all_data, aes(x = date, y = total_listings, group = factor(district), color = group)) +
geom_line(size = 1) +
geom_point(size = 1.5) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Total Listings Over Time by District",
x = "Date",
y = "Total Listings",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# Folder with CSV files
data_folder <- "data"
# List CSV files
files <- list.files(path = data_folder, pattern = "\\.csv$", full.names = TRUE)
# Function to read and clean CSV
read_listing <- function(file) {
df <- read_csv(file, col_types = cols(
district = col_integer(),
total_listings = col_integer(),
entire_homes = col_integer()
))
df <- df %>%
mutate(date = ymd(basename(file) %>% str_remove("\\.csv"))) %>%
mutate(across(c(total_listings, entire_homes), ~replace_na(.x, 0)))
return(df)
}
# Read all data
all_data <- files %>% map_dfr(read_listing)
# Define groups
inner_city <- c(1,2,5,7,8,9,11,13)
district6 <- 6
outer_city <- setdiff(1:23, c(inner_city, district6))
all_data <- all_data %>%
mutate(group = case_when(
district == district6 ~ "District 6",
district %in% inner_city ~ "Inner City",
TRUE ~ "Outer City"
))
# Plot all 23 districts over time
ggplot(all_data, aes(x = date, y = total_listings, group = factor(district), color = group)) +
geom_line(size = 1) +
geom_point(size = 1.5) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Total Listings Over Time by District",
x = "Date",
y = "Total Listings",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# ---------- Plot 1: Total Listings ----------
ggplot(all_data, aes(x = date, y = total_listings, group = factor(district), color = group)) +
geom_line(size = 1) +
geom_point(size = 1.5) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Total Listings Over Time by District",
x = "Date",
y = "Total Listings",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# ---------- Plot 2: Entire Homes ----------
ggplot(all_data, aes(x = date, y = entire_homes, group = factor(district), color = group)) +
geom_line(size = 1) +
geom_point(size = 1.5) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Booking.com Entire Homes Over Time by District",
x = "Date",
y = "Entire Homes",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
# ---------- Plot 3: Percentage of Entire Homes ----------
all_data <- all_data %>%
mutate(entire_home_pct = ifelse(total_listings == 0, 0, entire_homes / total_listings * 100))
ggplot(all_data, aes(x = date, y = entire_home_pct, group = factor(district), color = group)) +
geom_line(size = 1) +
geom_point(size = 1.5) +
scale_color_manual(values = c("District 6" = "red",
"Inner City" = "orange",
"Outer City" = "lightgrey")) +
labs(title = "Percentage of Entire Homes Over Time by District",
x = "Date",
y = "Entire Homes (%)",
color = "Group") +
theme_minimal() +
theme(text = element_text(size = 14))
